const streets=document.querySelector(".streets"),tbody=document.querySelector("tbody"),streetName=document.getElementById("street-name"),input=document.querySelector(".input");function getStreets(e){return fetch(`https://api.winnipegtransit.com/v3/streets.json?api-key=CwIZIJs65o3ruL2pbvnE&name=${e}`).then(e=>e.json())}function getStops(e){return fetch(`https://api.winnipegtransit.com/v3/stops.json?api-key=CwIZIJs65o3ruL2pbvnE&street=${e}`).then(e=>e.json())}function getStopSchedule(e){return fetch(`https://api.winnipegtransit.com/v3/stops/${e}/schedule.json?api-key=CwIZIJs65o3ruL2pbvnE&max-results-per-route=2`).then(e=>e.json())}function search(e){"Enter"===e.key&&(e.preventDefault(),""!==input.value&&(streets.innerHTML="",getStreets(input.value).then(e=>{if(0===e.streets.length)streets.insertAdjacentHTML("beforeend","No Streets found");else{for(const t of e.streets)insertHTMLForStreets(t);handleClickOnEachStreet()}}),input.value=""))}function insertHTMLForStreets(e){streets.insertAdjacentHTML("beforeend",`<a href="#" datakey=${e.key}>
      ${e.name}
    </a>`)}function handleClickOnEachStreet(){document.querySelectorAll("a").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),tbody.innerHTML="",streetName.innerHTML="",getStopsForEachStreet(e.target.getAttribute("datakey"))})}),tbody.innerHTML=""}function getStopsForEachStreet(e){getStops(e).then(e=>{findNext2BusesForEachRoute(e.stops.map(function(e){return getStopSchedule(e.key)}))})}function findNext2BusesForEachRoute(e){Promise.all(e).then(e=>{for(const t of e)for(const i of t["stop-schedule"]["route-schedules"]){let n=t["stop-schedule"].stop.street.name,r=t["stop-schedule"].stop["cross-street"].name,s=t["stop-schedule"].stop.direction,o=i.route.number;streetName.innerHTML=`Displaying results for ${n}`,i["scheduled-stops"].forEach(e=>{let t=new Date(e.times.arrival.estimated);e=t.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});insertHTMLForEachStops(n,s,r,o,e)})}})}function insertHTMLForEachStops(e,t,n,r,s){tbody.insertAdjacentHTML("beforeend",`<tr>
  <td>${e}</td>
  <td>${n}</td>
  <td>${t}</td>
  <td>${r}</td>
  <td>${s}</td>
  </tr>
  `)}input.addEventListener("keypress",search);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJzdHJlZXRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGJvZHkiLCJzdHJlZXROYW1lIiwiZ2V0RWxlbWVudEJ5SWQiLCJpbnB1dCIsImdldFN0cmVldHMiLCJpbnB1dFN0cmluZyIsImZldGNoIiwidGhlbiIsIlJlc3BvbnNlIiwianNvbiIsImdldFN0b3BzIiwia2V5IiwiZ2V0U3RvcFNjaGVkdWxlIiwic2VhcmNoIiwiZSIsInByZXZlbnREZWZhdWx0IiwidmFsdWUiLCJpbm5lckhUTUwiLCJsZW5ndGgiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJzdHJlZXQiLCJpbnNlcnRIVE1MRm9yU3RyZWV0cyIsImhhbmRsZUNsaWNrT25FYWNoU3RyZWV0IiwibmFtZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXRlbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJnZXRTdG9wc0ZvckVhY2hTdHJlZXQiLCJ0YXJnZXQiLCJnZXRBdHRyaWJ1dGUiLCJmaW5kTmV4dDJCdXNlc0ZvckVhY2hSb3V0ZSIsInN0b3BzIiwibWFwIiwic3RvcFNjaGVkdWxlIiwiUHJvbWlzZSIsImFsbCIsInNlbGVjdGVkUm91dGUiLCJyb3V0ZXMiLCJzdG9wTmFtZSIsInN0b3AiLCJjcm9zc1N0cmVldCIsImRpcmVjdGlvbiIsImJ1c051bWJlciIsInJvdXRlIiwibnVtYmVyIiwidGltZVRvQ29udmVydCIsIkRhdGUiLCJ0aW1lcyIsImFycml2YWwiLCJlc3RpbWF0ZWQiLCJ0aW1lIiwidG9Mb2NhbGVTdHJpbmciLCJob3VyIiwibWludXRlIiwiaG91cjEyIiwiaW5zZXJ0SFRNTEZvckVhY2hTdG9wcyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBQUEsUUFBQUMsU0FBQUMsY0FBQSxZQUNBQyxNQUFBRixTQUFBQyxjQUFBLFNBQ0FFLFdBQUFILFNBQUFJLGVBQUEsZUFDQUMsTUFBQUwsU0FBQUMsY0FBQSxVQUlBLFNBQUFLLFdBQUFDLEdBQ0EsT0FBQUMsMkZBQUFELEtBQ0FFLEtBQUFDLEdBQ0FBLEVBQUFDLFFBSUEsU0FBQUMsU0FBQUMsR0FDQSxPQUFBTCwyRkFBQUssS0FDQUosS0FBQUMsR0FDQUEsRUFBQUMsUUFJQSxTQUFBRyxnQkFBQUQsR0FDQSxPQUFBTCxrREFBQUssd0VBQ0FKLEtBQUFDLEdBQ0FBLEVBQUFDLFFBSUEsU0FBQUksT0FBQUMsR0FFQSxVQUFBQSxFQUFBSCxNQUNBRyxFQUFBQyxpQkFFQSxLQUFBWixNQUFBYSxRQUNBbkIsUUFBQW9CLFVBQUEsR0FDQWIsV0FBQUQsTUFBQWEsT0FDQVQsS0FBQUUsSUFDQSxHQUFBLElBQUFBLEVBQUFaLFFBQUFxQixPQUNBckIsUUFBQXNCLG1CQUFBLFlBQ0Esd0JBQ0EsQ0FDQSxJQUFBLE1BQUFDLEtBQUFYLEVBQUFaLFFBQ0F3QixxQkFBQUQsR0FFQUUsNkJBR0FuQixNQUFBYSxNQUFBLEtBS0EsU0FBQUsscUJBQUFELEdBQ0F2QixRQUFBc0IsbUJBQUEsbUNBQ0FDLEVBQUFUO1FBQ0FTLEVBQUFHO1dBSUEsU0FBQUQsMEJBQ0F4QixTQUFBMEIsaUJBQUEsS0FBQUMsUUFBQUMsSUFDQUEsRUFBQUMsaUJBQUEsUUFBQSxTQUFBYixHQUNBQSxFQUFBQyxpQkFDQWYsTUFBQWlCLFVBQUEsR0FDQWhCLFdBQUFnQixVQUFBLEdBRUFXLHNCQURBZCxFQUFBZSxPQUFBQyxhQUFBLGdCQUlBOUIsTUFBQWlCLFVBQUEsR0FHQSxTQUFBVyxzQkFBQWpCLEdBQ0FELFNBQUFDLEdBQ0FKLEtBQUEsSUFLQXdCLDJCQUpBQyxFQUFBQSxNQUFBQyxJQUFBLFNBQUFWLEdBRUEsT0FEQVgsZ0JBQUFXLEVBQUFaLFVBT0EsU0FBQW9CLDJCQUFBRyxHQUNBQyxRQUFBQyxJQUFBRixHQUNBM0IsS0FBQSxJQUNBLElBQUEsTUFBQThCLEtBQUFILEVBQ0EsSUFBQSxNQUFBSSxLQUFBRCxFQUFBLGlCQUFBLG1CQUFBLENBQ0EsSUFBQUUsRUFBQUYsRUFBQSxpQkFBQUcsS0FBQXBCLE9BQUFHLEtBQ0FrQixFQUFBSixFQUFBLGlCQUFBRyxLQUFBLGdCQUFBakIsS0FDQW1CLEVBQUFMLEVBQUEsaUJBQUFHLEtBQUFFLFVBQ0FDLEVBQUFMLEVBQUFNLE1BQUFDLE9BQ0E1QyxXQUFBZ0Isb0NBQUFzQixJQUNBRCxFQUFBLG1CQUFBYixRQUFBLElBQ0EsSUFBQXFCLEVBQUEsSUFBQUMsS0FBQUgsRUFBQUksTUFBQUMsUUFBQUMsV0FDQUMsRUFBQUwsRUFBQU0sZUFBQSxRQUFBLENBQUFDLEtBQUEsVUFBQUMsT0FBQSxVQUFBQyxRQUFBLElBQ0FDLHVCQUFBakIsRUFBQUcsRUFBQUQsRUFBQUUsRUFBQVEsUUFPQSxTQUFBSyx1QkFBQWpDLEVBQUFtQixFQUFBRCxFQUFBRSxFQUFBUSxHQUNBbkQsTUFBQW1CLG1CQUFBO1FBRUFJO1FBQ0FrQjtRQUNBQztRQUNBQztRQUNBUTs7S0ExR0FoRCxNQUFBd0IsaUJBQUEsV0FBQWQiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc3RyZWV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdHJlZXRzJyk7XHJcbmNvbnN0IHRib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGJvZHknKTtcclxuY29uc3Qgc3RyZWV0TmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdHJlZXQtbmFtZScpO1xyXG5jb25zdCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dCcpO1xyXG5pbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIHNlYXJjaCk7XHJcblxyXG5cclxuZnVuY3Rpb24gZ2V0U3RyZWV0cyhpbnB1dFN0cmluZykgeyAgICAgICAgICAvL3JldHVybiBhIGxpc3Qgb2Ygc3RyZWV0cyB0aGF0IG1hdGNoIHRoZSBzZWFyY2ggcXVlcnlcclxuICAgIHJldHVybiBmZXRjaChgaHR0cHM6Ly9hcGkud2lubmlwZWd0cmFuc2l0LmNvbS92My9zdHJlZXRzLmpzb24/YXBpLWtleT1Dd0laSUpzNjVvM3J1TDJwYnZuRSZuYW1lPSR7aW5wdXRTdHJpbmd9YClcclxuICAgICAgICAudGhlbihSZXNwb25zZSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U3RvcHMoa2V5KSB7ICAgICAgICAvL3JldHVybiBhbGwgdGhlIHN0b3BzIG9uIGEgdGhlIHNlbGVjdGVkIHN0cmVldFxyXG4gICAgcmV0dXJuIGZldGNoKGBodHRwczovL2FwaS53aW5uaXBlZ3RyYW5zaXQuY29tL3YzL3N0b3BzLmpzb24/YXBpLWtleT1Dd0laSUpzNjVvM3J1TDJwYnZuRSZzdHJlZXQ9JHtrZXl9YClcclxuICAgICAgICAudGhlbihSZXNwb25zZSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U3RvcFNjaGVkdWxlKGtleSkgeyAgICAgICAgIC8vcmV0dXJuIGxpc3Qgb2YgbmV4dCBidXNlcyBmb3IgZWFjaCByb3V0ZVxyXG4gICAgcmV0dXJuIGZldGNoKGBodHRwczovL2FwaS53aW5uaXBlZ3RyYW5zaXQuY29tL3YzL3N0b3BzLyR7a2V5fS9zY2hlZHVsZS5qc29uP2FwaS1rZXk9Q3dJWklKczY1bzNydUwycGJ2bkUmbWF4LXJlc3VsdHMtcGVyLXJvdXRlPTJgKVxyXG4gICAgICAgIC50aGVuKFJlc3BvbnNlID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIFJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBzZWFyY2goZSkgeyAgICAgICAgLy9hbGxvdyB1c2VycyB0byBzZWFyY2ggZm9yIGEgcGFydGljdWxhciBzdHJlZXQgYnkgbmFtZVxyXG5cclxuICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgaWYgKGlucHV0LnZhbHVlICE9PSAnJykge1xyXG4gICAgICAgICAgICBzdHJlZXRzLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGdldFN0cmVldHMoaW5wdXQudmFsdWUpXHJcbiAgICAgICAgICAgICAgICAudGhlbihqc29uID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoanNvbi5zdHJlZXRzLmxlbmd0aCA9PT0gMCkgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWV0cy5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgTm8gU3RyZWV0cyBmb3VuZGApXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdHJlZXQgb2YganNvbi5zdHJlZXRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRIVE1MRm9yU3RyZWV0cyhzdHJlZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUNsaWNrT25FYWNoU3RyZWV0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcbmZ1bmN0aW9uIGluc2VydEhUTUxGb3JTdHJlZXRzKHN0cmVldCkgeyAgICAgICAgIC8vZ2V0IGJhY2sgYSBsaXN0IG9mIG1hdGNoaW5nIHN0cmVldHNcclxuICAgIHN0cmVldHMuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLFxyXG4gICAgICAgIGA8YSBocmVmPVwiI1wiIGRhdGFrZXk9JHtzdHJlZXQua2V5fT5cclxuICAgICAgJHtzdHJlZXQubmFtZX1cclxuICAgIDwvYT5gKVxyXG59O1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2xpY2tPbkVhY2hTdHJlZXQoKSB7ICAgICAgICAvL2FkZCBvbmNsaWNrIGV2ZW50IGxpc3RlbmVyIHRvIGVhY2ggc3RyZWV0XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdhJykuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0Ym9keS5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgICAgICAgICBzdHJlZXROYW1lLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGxldCBrZXkgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGFrZXknKTtcclxuICAgICAgICAgICAgZ2V0U3RvcHNGb3JFYWNoU3RyZWV0KGtleSk7XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbiAgICB0Ym9keS5pbm5lckhUTUwgPSBcIlwiO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRTdG9wc0ZvckVhY2hTdHJlZXQoa2V5KSB7ICAgICAgIC8vZ2V0IGFsbCB0aGUgc3RvcHMgb24gdGhlIGNob3NlbiBzdHJlZXQgb24gY2xpY2tcclxuICAgIGdldFN0b3BzKGtleSlcclxuICAgICAgICAudGhlbigoc3RvcHMpID0+IHtcclxuICAgICAgICAgICAgbGV0IHN0b3BTY2hlZHVsZSA9IHN0b3BzLnN0b3BzLm1hcChmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNjaGVkdWxlID0gZ2V0U3RvcFNjaGVkdWxlKG5hbWUua2V5KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzY2hlZHVsZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgZmluZE5leHQyQnVzZXNGb3JFYWNoUm91dGUoc3RvcFNjaGVkdWxlKTtcclxuICAgICAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBmaW5kTmV4dDJCdXNlc0ZvckVhY2hSb3V0ZShzdG9wU2NoZWR1bGUpIHsgICAgICAgIC8vZmluZCB0aGUgbmV4dCAyIGJ1c2VzIGZvciBlYWNoIHJvdXRlXHJcbiAgICBQcm9taXNlLmFsbChzdG9wU2NoZWR1bGUpXHJcbiAgICAgICAgLnRoZW4oKHN0b3BTY2hlZHVsZSkgPT4ge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNlbGVjdGVkUm91dGUgb2Ygc3RvcFNjaGVkdWxlKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJvdXRlcyBvZiBzZWxlY3RlZFJvdXRlWydzdG9wLXNjaGVkdWxlJ11bJ3JvdXRlLXNjaGVkdWxlcyddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0b3BOYW1lID0gc2VsZWN0ZWRSb3V0ZVsnc3RvcC1zY2hlZHVsZSddLnN0b3Auc3RyZWV0Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNyb3NzU3RyZWV0ID0gc2VsZWN0ZWRSb3V0ZVsnc3RvcC1zY2hlZHVsZSddLnN0b3BbJ2Nyb3NzLXN0cmVldCddLm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRpcmVjdGlvbiA9IHNlbGVjdGVkUm91dGVbJ3N0b3Atc2NoZWR1bGUnXS5zdG9wLmRpcmVjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYnVzTnVtYmVyID0gcm91dGVzLnJvdXRlLm51bWJlcjtcclxuICAgICAgICAgICAgICAgICAgICBzdHJlZXROYW1lLmlubmVySFRNTCA9IGBEaXNwbGF5aW5nIHJlc3VsdHMgZm9yICR7c3RvcE5hbWV9YDtcclxuICAgICAgICAgICAgICAgICAgICByb3V0ZXNbXCJzY2hlZHVsZWQtc3RvcHNcIl0uZm9yRWFjaCgocm91dGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRpbWVUb0NvbnZlcnQgPSBuZXcgRGF0ZShyb3V0ZS50aW1lcy5hcnJpdmFsLmVzdGltYXRlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0aW1lID0gdGltZVRvQ29udmVydC50b0xvY2FsZVN0cmluZygnZW4tVVMnLCB7IGhvdXI6ICdudW1lcmljJywgbWludXRlOiAnbnVtZXJpYycsIGhvdXIxMjogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0SFRNTEZvckVhY2hTdG9wcyhzdG9wTmFtZSwgZGlyZWN0aW9uLCBjcm9zc1N0cmVldCwgYnVzTnVtYmVyLCB0aW1lKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gaW5zZXJ0SFRNTEZvckVhY2hTdG9wcyhuYW1lLCBkaXJlY3Rpb24sIGNyb3NzU3RyZWV0LCBidXNOdW1iZXIsIHRpbWUpIHsgICAgICAgIC8vIHBvcHVsYXRlIGRhdGEgb2YgbmV4dCAyIGJ1c2VzIGZvciBlYWNoIHJvdXRlIGludG8gdGhlIHRhYmxlIGF0IGVhY2ggc3RvcFxyXG4gICAgdGJvZHkuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLFxyXG4gICAgICAgIGA8dHI+XHJcbiAgPHRkPiR7bmFtZX08L3RkPlxyXG4gIDx0ZD4ke2Nyb3NzU3RyZWV0fTwvdGQ+XHJcbiAgPHRkPiR7ZGlyZWN0aW9ufTwvdGQ+XHJcbiAgPHRkPiR7YnVzTnVtYmVyfTwvdGQ+XHJcbiAgPHRkPiR7dGltZX08L3RkPlxyXG4gIDwvdHI+XHJcbiAgYClcclxufTsiXX0=
